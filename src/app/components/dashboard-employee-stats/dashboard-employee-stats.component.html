<div class="dashboard-container">
  <!-- Navigation Bar -->
  <app-dashboard-navbar></app-dashboard-navbar>

  <!-- Main Content -->
  <div class="dashboard-content">
    <div>
      <!-- Header -->
      <div class="stats-header">
        <h1 class="page-title">Employee Summary</h1>
        <div class="header-controls">
          <div class="display-toggle">
            <span class="toggle-label">Display Data in</span>
            <div class="toggle-buttons">
              <button class="toggle-btn" [class.active]="displayMode === 'monthly'"
                (click)="toggleDisplayMode('monthly')">
                Monthly
              </button>
              <button class="toggle-btn" [class.active]="displayMode === 'yearly'"
                (click)="toggleDisplayMode('yearly')">
                Yearly
              </button>
            </div>
          </div>
          <div class="period-selector">
            <span class="period-label">Periode</span>
            <div class="period-input-wrapper">
              <p-datepicker [(ngModel)]="selectedPeriod" [view]="datePickerView" [dateFormat]="getDatePickerFormat()"
                inputId="period-calendar" [showIcon]="true" size="small" [iconDisplay]="'input'"
                inputStyleClass="period-input" panelStyleClass="period-calendar-panel"
                (onSelect)="onPeriodChange($event)">
                <ng-template #inputicon let-clickCallBack="clickCallBack">
                  <img src="/dashboard/icon - Callendar.svg" alt="Calendar" class="calendar-icon-template"
                    (click)="clickCallBack($event)" />
                </ng-template>
              </p-datepicker>
            </div>
          </div>
        </div>
      </div>

      <div class="charts-container">
        <!-- Charts Grid -->
        <div class="charts-grid">
          <!-- Left Column: Attendance Summary Chart + KPI Cards -->
          <div class="left-column">
            <!-- Attendance Summary Chart -->
            <div class="chart-card website-view">
              <h3 class="chart-title">Attendance Summary</h3>
              <div class="chart-container">
                <p-chart type="bar" [data]="attendanceChartData" [options]="attendanceChartOptions"></p-chart>
              </div>
              <!-- KPI -->
              <div class="kpi-cards">
                <div class="kpi-card kpi-card-1">
                  <div class="kpi-left-border"></div>
                  <div class="kpi-content-wrapper">
                    <div class="kpi-header">
                      <div class="kpi-label">Total Working Days</div>
                      <div class="kpi-icon">
                        <img src="/dashboard/icon - Info.svg" alt="Info" class="info-icon" />
                      </div>
                    </div>
                    <div class="kpi-value">{{ kpiData.totalWorkingDays }}</div>
                  </div>
                </div>
                <div class="kpi-card kpi-card-2">
                  <div class="kpi-left-border"></div>
                  <div class="kpi-content-wrapper">
                    <div class="kpi-header">
                      <div class="kpi-label">Actual Working Hours</div>
                      <div class="kpi-icon">
                        <img src="/dashboard/icon - Info.svg" alt="Info" class="info-icon" />
                      </div>
                    </div>
                    <div class="kpi-value">{{ kpiData.actualWorkingHours }}</div>
                  </div>
                </div>
                <div class="kpi-card kpi-card-3">
                  <div class="kpi-left-border"></div>
                  <div class="kpi-content-wrapper">
                    <div class="kpi-header">
                      <div class="kpi-label">Total Working Hours</div>
                      <div class="kpi-icon">
                        <img src="/dashboard/icon - Info.svg" alt="Info" class="info-icon" />
                      </div>
                    </div>
                    <div class="kpi-value">{{ kpiData.totalWorkingHours }}</div>
                  </div>
                </div>
                <div class="kpi-card kpi-card-4">
                  <div class="kpi-left-border"></div>
                  <div class="kpi-content-wrapper">
                    <div class="kpi-header">
                      <div class="kpi-label">Total Late Coming</div>
                      <div class="kpi-icon">
                        <img src="/dashboard/icon - Info.svg" alt="Info" class="info-icon" />
                      </div>
                    </div>
                    <div class="kpi-value">{{ kpiData.totalLateComing }}</div>
                  </div>
                </div>
              </div>
            </div>

            <div class="chart-card-other">
              <h3 class="chart-title">Attendance Summary</h3>
              <div class="chart-container">
                <!-- <p-chart type="bar" [data]="attendanceChartData" [options]="attendanceChartOptions"></p-chart> -->
                <div class="colSmall w-[28.5px]">
                  <p-chart type="bar" [data]="attendanceChartData" [options]="attendanceChartOptions1"></p-chart>
                </div>
                <div class="colLarge max-w-[300px] overflow-x-scroll">
                  <div class="box" [style.width.px]="chartWidth">
                    <p-chart type="bar" [data]="attendanceChartData" [options]="attendanceChartOptions2"></p-chart>
                  </div>
                </div>
              </div>

              <!-- KPI -->
              <div class="kpi-cards">
                <div class="kpi-card kpi-card-1">
                  <div class="kpi-left-border"></div>
                  <div class="kpi-content-wrapper">
                    <div class="kpi-header">
                      <div class="kpi-label">Total Working Days</div>
                      <div class="kpi-icon">
                        <img src="/dashboard/icon - Info.svg" alt="Info" class="info-icon" />
                      </div>
                    </div>
                    <div class="kpi-value">{{ kpiData.totalWorkingDays }}</div>
                  </div>
                </div>
                <div class="kpi-card kpi-card-2">
                  <div class="kpi-left-border"></div>
                  <div class="kpi-content-wrapper">
                    <div class="kpi-header">
                      <div class="kpi-label">Actual Working Hours</div>
                      <div class="kpi-icon">
                        <img src="/dashboard/icon - Info.svg" alt="Info" class="info-icon" />
                      </div>
                    </div>
                    <div class="kpi-value">{{ kpiData.actualWorkingHours }}</div>
                  </div>
                </div>
                <div class="kpi-card kpi-card-3">
                  <div class="kpi-left-border"></div>
                  <div class="kpi-content-wrapper">
                    <div class="kpi-header">
                      <div class="kpi-label">Total Working Hours</div>
                      <div class="kpi-icon">
                        <img src="/dashboard/icon - Info.svg" alt="Info" class="info-icon" />
                      </div>
                    </div>
                    <div class="kpi-value">{{ kpiData.totalWorkingHours }}</div>
                  </div>
                </div>
                <div class="kpi-card kpi-card-4">
                  <div class="kpi-left-border"></div>
                  <div class="kpi-content-wrapper">
                    <div class="kpi-header">
                      <div class="kpi-label">Total Late Coming</div>
                      <div class="kpi-icon">
                        <img src="/dashboard/icon - Info.svg" alt="Info" class="info-icon" />
                      </div>
                    </div>
                    <div class="kpi-value">{{ kpiData.totalLateComing }}</div>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Right Column: Attendance Completeness Chart -->
          <div class="right-column">
            <div class="chart-card">
              <h3 class="chart-title">Attendance Completeness</h3>
              <div class="chart-container pie-chart">
                <p-chart type="pie" [data]="completenessChartData" [options]="completenessChartOptions"></p-chart>
              </div>
            </div>
          </div>
        </div>

        <!-- Charts Grid -->
        <div class="charts-grid">

          <!-- Right Column: Overall Task Progress Chart -->
          <div class="right-column">
            <div class="chart-card">
              <h3 class="chart-title">Overall Task Progress</h3>
              <div class="chart-container pie-chart">
                <p-chart type="pie" [data]="progressChartData" [options]="progressChartOptions"></p-chart>
              </div>
            </div>
          </div>

          <!-- Left Column: Task Completion in All Project -->
          <div class="left-column">
            <!-- Task Completion in All Project Chart -->
            <div class="chart-card website-view">
              <div class="chart-title-container">
                <h3 class="chart-title">Task Completion in All Project</h3>
                <div class="legend-container">
                  <div class="legend-item">
                    <div class="legend-item-color legend-item-color-completed"></div>
                    <div class="legend-item-label">Completed</div>
                  </div>
                  <div class="legend-item">
                    <div class="legend-item-color legend-item-color-created"></div>
                    <div class="legend-item-label">Created Task</div>
                  </div>
                </div>
              </div>
              <div class="chart-container">
                <p-chart type="line" [data]="taskCompletionChartData" [options]="taskCompletionChartOptions"></p-chart>
              </div>

              <!-- KPI Cards -->
              <div class="kpi-cards-1">
                <div class="kpi-card-1">
                  <div class="kpi-left-border"></div>
                  <div class="kpi-content-wrapper-1">
                    <div class="kpi-header-1">
                      <div class="kpi-label-1 mobile-first">Total Task Completed</div>
                      <div class="kpi-icon">
                        <img src="/dashboard/icon - Info.svg" alt="Info" class="info-icon" />
                      </div>
                    </div>
                    <div class="kpi-value-wrapper">
                      <div class="kpi-value-container">
                        <div class="kpi-value-1">{{ taskKpiData.totalTaskCompleted }}</div>
                        <div class="kpi-trend trend-up">
                          <span class="trend-value">{{ taskKpiData.totalTaskCompletedTrend }}</span>
                          <img src="/dashboard/Icon - Increase.svg" alt="Increase" class="trend-arrow" />
                        </div>
                      </div>
                      <div class="kpi-comparison">Last Year : {{ taskKpiData.totalTaskCompletedLastYear }} Task</div>
                    </div>
                  </div>
                </div>
                <div class="kpi-card-1">
                  <div class="kpi-left-border"></div>
                  <div class="kpi-content-wrapper-1">
                    <div class="kpi-header-1">
                      <div class="kpi-label-1">Most Completed Tasks At</div>
                      <div class="kpi-icon">
                        <img src="/dashboard/icon - Info.svg" alt="Info" class="info-icon" />
                      </div>
                    </div>
                    <div class="kpi-value-wrapper">
                      <div class="kpi-value-container">
                        <div class="kpi-value-1">{{ taskKpiData.mostCompletedTasksAt }}</div>
                      </div>
                      <div class="kpi-comparison">{{ taskKpiData.mostCompletedTasksAtMonth }}</div>
                    </div>
                  </div>
                </div>
                <div class="kpi-card-1">
                  <div class="kpi-left-border"></div>
                  <div class="kpi-content-wrapper-1">
                    <div class="kpi-header-1">
                      <div class="kpi-label-1 mobile-second">Total Task Created</div>
                      <div class="kpi-icon">
                        <img src="/dashboard/icon - Info.svg" alt="Info" class="info-icon" />
                      </div>
                    </div>
                    <div class="kpi-value-wrapper">
                      <div class="kpi-value-container">
                        <div class="kpi-value-1">{{ taskKpiData.totalTaskCreated }}</div>
                        <div class="kpi-trend trend-down">
                          <span class="trend-value">{{ taskKpiData.totalTaskCreatedTrend }}</span>
                          <img src="/dashboard/Icon - Decrease.svg" alt="Decrease" class="trend-arrow" />
                        </div>
                      </div>
                      <div class="kpi-comparison">Last Year : {{ taskKpiData.totalTaskCreatedLastYear }} Task</div>
                    </div>
                  </div>
                </div>
                <div class="kpi-card-1">
                  <div class="kpi-left-border"></div>
                  <div class="kpi-content-wrapper-1">
                    <div class="kpi-header-1">
                      <div class="kpi-label-1">Most Completed Tasks At</div>
                      <div class="kpi-icon">
                        <img src="/dashboard/icon - Info.svg" alt="Info" class="info-icon" />
                      </div>
                    </div>
                    <div class="kpi-value-wrapper">
                      <div class="kpi-value-container">
                        <div class="kpi-value-1">{{ taskKpiData.mostCompletedTaskType }}</div>
                      </div>
                      <div class="kpi-comparison">{{ taskKpiData.mostCompletedTaskTypeCount }} Task</div>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <div class="chart-card-other">
              <div class="chart-title-container">
                <h3 class="chart-title">Task Completion in All Project</h3>
                <div class="legend-container">
                  <div class="legend-item">
                    <div class="legend-item-color legend-item-color-completed"></div>
                    <div class="legend-item-label">Completed</div>
                  </div>
                  <div class="legend-item">
                    <div class="legend-item-color legend-item-color-created"></div>
                    <div class="legend-item-label">Created Task</div>
                  </div>
                </div>
              </div>

              <div class="chart-container">
                <!-- <p-chart type="bar" [data]="attendanceChartData" [options]="attendanceChartOptions"></p-chart> -->
                <div class="colSmall w-[25.5px] absolute bg-white z-1">
                  <p-chart type="line" [data]="taskCompletionChartData1" [options]="taskCompletionChartOptions1"></p-chart>
                </div>
                <div class="colLarge max-w-[325px] overflow-x-scroll ml-1.5">
                  <div class="box" [style.width.px]="chartWidth">
                    <p-chart type="line" [data]="taskCompletionChartData" [options]="taskCompletionChartOptions2"></p-chart>
                  </div>
                </div>
              </div>

              <!-- KPI -->

              <!-- KPI Cards -->
              <div class="kpi-cards-1">
                <div class="kpi-card-1">
                  <div class="kpi-left-border"></div>
                  <div class="kpi-content-wrapper-1">
                    <div class="kpi-header-1">
                      <div class="kpi-label-1 mobile-first">Total Task Completed</div>
                      <div class="kpi-icon">
                        <img src="/dashboard/icon - Info.svg" alt="Info" class="info-icon" />
                      </div>
                    </div>
                    <div class="kpi-value-wrapper">
                      <div class="kpi-value-container">
                        <div class="kpi-value-1">{{ taskKpiData.totalTaskCompleted }}</div>
                        <div class="kpi-trend trend-up">
                          <span class="trend-value">{{ taskKpiData.totalTaskCompletedTrend }}</span>
                          <img src="/dashboard/Icon - Increase.svg" alt="Increase" class="trend-arrow" />
                        </div>
                      </div>
                      <div class="kpi-comparison">Last Year : {{ taskKpiData.totalTaskCompletedLastYear }} Task</div>
                    </div>
                  </div>
                </div>
                <div class="kpi-card-1">
                  <div class="kpi-left-border"></div>
                  <div class="kpi-content-wrapper-1">
                    <div class="kpi-header-1">
                      <div class="kpi-label-1">Most Completed Tasks At</div>
                      <div class="kpi-icon">
                        <img src="/dashboard/icon - Info.svg" alt="Info" class="info-icon" />
                      </div>
                    </div>
                    <div class="kpi-value-wrapper">
                      <div class="kpi-value-container">
                        <div class="kpi-value-1">{{ taskKpiData.mostCompletedTasksAt }}</div>
                      </div>
                      <div class="kpi-comparison">{{ taskKpiData.mostCompletedTasksAtMonth }}</div>
                    </div>
                  </div>
                </div>
                <div class="kpi-card-1">
                  <div class="kpi-left-border"></div>
                  <div class="kpi-content-wrapper-1">
                    <div class="kpi-header-1">
                      <div class="kpi-label-1 mobile-second">Total Task Created</div>
                      <div class="kpi-icon">
                        <img src="/dashboard/icon - Info.svg" alt="Info" class="info-icon" />
                      </div>
                    </div>
                    <div class="kpi-value-wrapper">
                      <div class="kpi-value-container">
                        <div class="kpi-value-1">{{ taskKpiData.totalTaskCreated }}</div>
                        <div class="kpi-trend trend-down">
                          <span class="trend-value">{{ taskKpiData.totalTaskCreatedTrend }}</span>
                          <img src="/dashboard/Icon - Decrease.svg" alt="Decrease" class="trend-arrow" />
                        </div>
                      </div>
                      <div class="kpi-comparison">Last Year : {{ taskKpiData.totalTaskCreatedLastYear }} Task</div>
                    </div>
                  </div>
                </div>
                <div class="kpi-card-1">
                  <div class="kpi-left-border"></div>
                  <div class="kpi-content-wrapper-1">
                    <div class="kpi-header-1">
                      <div class="kpi-label-1">Most Completed Tasks At</div>
                      <div class="kpi-icon">
                        <img src="/dashboard/icon - Info.svg" alt="Info" class="info-icon" />
                      </div>
                    </div>
                    <div class="kpi-value-wrapper">
                      <div class="kpi-value-container">
                        <div class="kpi-value-1">{{ taskKpiData.mostCompletedTaskType }}</div>
                      </div>
                      <div class="kpi-comparison">{{ taskKpiData.mostCompletedTaskTypeCount }} Task</div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

      </div>

      <!-- Leave Recap Table -->
      <div class="leave-recap-card">
        <h3 class="chart-title leave-recap-title">Leave Recap</h3>
        <div class="leave-recap-table-wrapper">
          <table class="leave-recap-table">
            <thead>
              <tr>
                <th class="sticky-column" (click)="sortTable('leaveCode')">
                  <div class="th-content">
                    <span>Leave Code</span>
                    <img src="/dashboard/icon - UpDown.svg" alt="Sort" class="sort-icon" />
                  </div>
                </th>
                <th (click)="sortTable('requestedOn')">
                  <div class="th-content">
                    <span>Requested On</span>
                    <img src="/dashboard/icon - UpDown.svg" alt="Sort" class="sort-icon" />
                  </div>
                </th>
                <th (click)="sortTable('leaveType')">
                  <div class="th-content">
                    <span>Leave Type</span>
                    <img src="/dashboard/icon - UpDown.svg" alt="Sort" class="sort-icon" />
                  </div>
                </th>
                <th (click)="sortTable('startDate')">
                  <div class="th-content">
                    <span>Start Date</span>
                    <img src="/dashboard/icon - UpDown.svg" alt="Sort" class="sort-icon" />
                  </div>
                </th>
                <th (click)="sortTable('endDate')">
                  <div class="th-content">
                    <span>End Date</span>
                    <img src="/dashboard/icon - UpDown.svg" alt="Sort" class="sort-icon" />
                  </div>
                </th>
                <th (click)="sortTable('duration')">
                  <div class="th-content">
                    <span>Duration</span>
                    <img src="/dashboard/icon - UpDown.svg" alt="Sort" class="sort-icon" />
                  </div>
                </th>
                <th (click)="sortTable('day')">
                  <div class="th-content">
                    <span>Day</span>
                    <img src="/dashboard/icon - UpDown.svg" alt="Sort" class="sort-icon" />
                  </div>
                </th>
                <th (click)="sortTable('status')">
                  <div class="th-content">
                    <span>Status</span>
                    <img src="/dashboard/icon - UpDown.svg" alt="Sort" class="sort-icon" />
                  </div>
                </th>
                <th (click)="sortTable('reason')">
                  <div class="th-content">
                    <span>Reason</span>
                    <!-- <img src="/dashboard/icon - UpDown.svg" alt="Sort" class="sort-icon" /> -->
                  </div>
                </th>
              </tr>
            </thead>
            <tbody>
              @for (leave of leaveRecapData; track leave.leaveCode + $index) {
              <tr>
                <td class="sticky-column"><span>{{ leave.leaveCode }}</span></td>
                <td>{{ leave.requestedOn }}</td>
                <td>{{ leave.leaveType }}</td>
                <td>{{ leave.startDate }}</td>
                <td>{{ leave.endDate }}</td>
                <td>{{ leave.duration }}</td>
                <td>{{ leave.day }}</td>
                <td>
                  <p-badge [value]="leave.status" severity="success" style="border-radius: 4px !important;" />
                </td>
                <td>{{ leave.reason }}</td>
              </tr>
              }
            </tbody>
          </table>
        </div>
      </div>

    </div>
  </div>
</div>